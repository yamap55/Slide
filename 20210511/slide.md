<style type="text/css">
  .reveal h1,
  .reveal h2,
  .reveal h3,
  .reveal h4,
  .reveal h5,
  .reveal h6 {
    text-transform: none;
  }
</style>

# システム設計勉強会第1回

---

## アジェンダ

- はじめに
- なぜソフトウェアの変更は大変なのか
- プログラムの変更が楽になる書き方
- 参考

---

## はじめに

---

![現場で役立つシステム設計の原則](./img/img01.png)

https://www.amazon.co.jp/dp/B073GSDBGT/

--

TODO:
- 何か思いでも書く？
- 内容としては↓と同じ感じになるから不要か？


---

## なぜソフトウェアの変更は大変なのか

--

- どこに何が書いてあるのかわからない
- 複数箇所の変更が必要
- 1箇所修正したら別の箇所に影響がでる

--

## 設計に問題がある

-- 

### 直接関係はない

- ドキュメントはしっかり整備されている
- コーディング規約に沿っている
- ユニットテスが書かれている

--

### 変更が大変なプログラムの特徴

- メソッド（関数）が長い
- クラスが大きい
- 引数が多い

--

## 変更するたびに変更が大変になる

--

### 作成時
- メソッドは短い
- クラスは小さい
- 引数も少ない

--

### ちょっとした変更
- if文1つと数行
- 変数1つとメソッド1つ
- 引数に1つ追加

--

### 結果

- 見通しが悪くなる
- 構造が入り組んでくる
- どこに何がかいてあるかわからなくなる

--

## 変更が大変になる

- ちょっとした変更を繰り返したコード

--

## システム設計とは

変更に強いシステムを作る

--

変更するたびに変更が大変になるシステム変更の負のスパイラルから抜け出すにはどうしたら良いのかを学んでいきます

---

## プログラムの変更が楽になる書き方

---

## わかりやすい名前を使う

--

## 悪い例
- 1文字
  - d, i, xなど
- 省略名
- 曖昧
  - data, arrayなど

※例外はあるが、迷うようなら使わない

--

## 名付けは重量
- 良い名前は一番大事
- 時間をかけて良い
- むしろ一番時間をかける所

--

## 理由
- 何を表しているのかわからない
- 良い名前を付けられないのは何かがおかしい
  - リファクタリングする指標
  - 設計や処理を見直す

--

## 同じ変数を使い回さない
- 適切な名前を付けると同じ変数に入れることができない
- 処理を行ったら処理済みとわかる名前を付ける
- 使い回さないことで影響範囲を局所化する

---

## メソッドとして独立させる

--

### 処理を区切る

- コメントや空白行で区切りを付ける
- 人間にとっての読みやすさ向上
- プログラムの構造は変わっていない

### メソッドとして切り出す
- コードがシンプルで読みやすくなる
- メソッド名からコードの意図が理解しやすい
- 切り出すことで独立した1つの部品になる
- 変更の影響をメソッドに閉じ込めやすい

### ポイント
- この処理では何をするの？に対する答えをメソッド化する
- 行数が切り出す指標ではない
  - 1,2行であっても切り出したほうが良い
  - 名前が付けられる

--

### 例

```python
def total_count():
  load_df = load()
  preprocessed_df　= preprocess(load_data)
  total_count = calc_count(preprocessed_df)
  s3_output(total_count)
```

---

## 異なるクラスの重複したコードをなくす

--

## 手順
- メソッドとして独立させる
- 共通処理を探す
- 別クラスもしくは独立させたメソッドを呼びだすように変更

--

### ポイント

- 結果的に同じ、似ている処理は共通化しない
- 本質的に重複しているかどうかが重要
- 本質的な処理、名称にする

---

## 狭い関心事に特化したクラスにする



---

## 参考

- 現場で役立つシステム設計の原則
  - https://www.amazon.co.jp/dp/B073GSDBGT/
- 作者による本への質問や回答
  - https://www.slideshare.net/masuda220/ss-79304804
